<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Display Salaries</title>
<style>


* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: Arial, sans-serif;
    background-color: #f6f6f6;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.header {
    background-color: #007bff;
    color: #fff;
    padding: 80px;
    text-align: center;
    height: 80px; 
}

.main-content {
    background-color: #fff;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
    margin-top: 20px; 
}

.card {
    background-color: #f9fafb;
    padding: 20px;
    margin-bottom: 20px;
    border-radius: 10px;
}

.card-header {
    font-weight: bold;
    margin-bottom: 10px;
}

.button {
    display: inline-block;
    padding: 10px 20px;
    background-color: #007bff;
    color: #fff;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

.button:hover {
    background-color: #0056b3;
}

.form-control {
    width: 100%;
    padding: 10px;
    margin-bottom: 10px;
    border: 1px solid #ced4da;
    border-radius: 5px;
}

.select-control {
    width: 100%;
    padding: 10px;
    margin-bottom: 10px;
    border: 1px solid #ced4da;
    border-radius: 5px;
    appearance: none;
    background: url("data:image/svg+xml,%3Csvg width='24' height='24' viewBox='0 0 24 24' fill='%23212121' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z'/%3E%3C/svg%3E") no-repeat;
    background-position: right 10px center;
    background-size: 20px;
}

.table {
    width: 100%;
    border-collapse: collapse;
}

.table th, .table td {
    border-bottom: 1px solid #dee2e6;
    padding: 10px;
    text-align: left;
}

.table th {
    background-color: #f6f6f6;
    color: #212529;
}


.controls {
    display: flex;
    flex-wrap: wrap;
    align-items: flex-start;
    margin-bottom: 20px; 
}

#searchBtn {
    margin-right: 10px; 
}

#clearBtn {
    margin-left: auto; /* pushes the clear button to the right */
}

/* back to top button */
#backToTopBtn {
    display: none; /* initially hide the button */
    position: fixed; /* fixed position */
    bottom: 20px; 
    right: 20px; 
}
</style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>Find where to move, to make the most money!</h1>
    </div>

    <div class="main-content">
        <div class="controls-container">
            <div class="controls">
                <label for="profession">Select Profession:</label>
                <select id="profession" class="select-control">
                    <option value="software">Software Developer</option>
                    <option value="mechanical">Mechanical Engineer</option>
                </select>

                <label for="sorting">Sort by Salary:</label>
                <select id="sorting" class="select-control">
                    <option value="highest">Highest to Lowest</option>
                    <option value="lowest">Lowest to Highest</option>
                </select>

                <label for="state">Select State:</label>
                <select id="state" class="select-control">

                    <option value="all">All States</option>
                    <option value="AL">Alabama</option>
                    <option value="AK">Alaska</option>
                    <option value="AZ">Arizona</option>
                    <option value="AR">Arkansas</option>
                    <option value="CA">California</option>
                    <option value="CO">Colorado</option>
                    <option value="CT">Connecticut</option>
                    <option value="DE">Delaware</option>
                    <option value="FL">Florida</option>
                    <option value="GA">Georgia</option>
                    <option value="HI">Hawaii</option>
                    <option value="ID">Idaho</option>
                    <option value="IL">Illinois</option>
                    <option value="IN">Indiana</option>
                    <option value="IA">Iowa</option>
                    <option value="KS">Kansas</option>
                    <option value="KY">Kentucky</option>
                    <option value="LA">Louisiana</option>
                    <option value="ME">Maine</option>
                    <option value="MD">Maryland</option>
                    <option value="MA">Massachusetts</option>
                    <option value="MI">Michigan</option>
                    <option value="MN">Minnesota</option>
                    <option value="MS">Mississippi</option>
                    <option value="MO">Missouri</option>
                    <option value="MT">Montana</option>
                    <option value="NE">Nebraska</option>
                    <option value="NV">Nevada</option>
                    <option value="NH">New Hampshire</option>
                    <option value="NJ">New Jersey</option>
                    <option value="NM">New Mexico</option>
                    <option value="NY">New York</option>
                    <option value="NC">North Carolina</option>
                    <option value="ND">North Dakota</option>
                    <option value="OH">Ohio</option>
                    <option value="OK">Oklahoma</option>
                    <option value="OR">Oregon</option>
                    <option value="PA">Pennsylvania</option>
                    <option value="RI">Rhode Island</option>
                    <option value="SC">South Carolina</option>
                    <option value="SD">South Dakota</option>
                    <option value="TN">Tennessee</option>
                    <option value="TX">Texas</option>
                    <option value="UT">Utah</option>
                    <option value="VT">Vermont</option>
                    <option value="VA">Virginia</option>
                    <option value="WA">Washington</option>
                    <option value="WV">West Virginia</option>
                    <option value="WI">Wisconsin</option>
                    <option value="WY">Wyoming</option>
            
                </select>

                <label for="city">Search City:</label>
                <input type="text" id="city" class="form-control" placeholder="Enter city name">
                <button id="searchBtn" class="button">Search</button>
                <button id="clearBtn" class="button">Clear Results</button>
            </div>
        </div>

        <div id="content">
            <table class="table" id="salaryTable">
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>City, State</th>
                        <th>Salary</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>
    </div>
</div>

<button id="backToTopBtn" class="button" onclick="scrollToTop()">Back to Top</button>

<script>
    function scrollToTop() {
        window.scrollTo({
            top: 0,
            behavior: 'auto' // changed 'smooth' to 'auto' for instant scrolling
        });
    }

    window.addEventListener('scroll', function() {
        var backToTopBtn = document.getElementById('backToTopBtn');
        if (window.scrollY > 100) { // shows button when scrolled down at 100px
            backToTopBtn.style.display = 'block'; // intially blocks button from being seen
        } else {
            backToTopBtn.style.display = 'none';
        }
    });
</script>
<script>
    document.addEventListener('DOMContentLoaded', function() {

        // parse CSV data
        function parseCSV(csv) {
            var lines = csv.split('\n');
            var data = [];
            for (var i = 0; i < lines.length; i++) {
                var columns = lines[i].split(',');
                if (columns.length === 4) { // make sure each row has four columns
                    data.push({
                        rank: parseInt(columns[0]),
                        city: columns[1],
                        state: columns[2].trim(), // trims leading and trailing whitespace
                        salary: parseInt(columns[3])
                    });
                }
            }
            return data;
        }

        // displays data in table
        function displayData(data) {
            var tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = ''; // clears previous data
            if (data.length === 0) {
                var row = document.createElement('tr');
                row.innerHTML = '<td colspan="3">No results</td>';
                tableBody.appendChild(row);
            } else {
                for (var i = 0; i < data.length; i++) {
                    var row = document.createElement('tr');

                    // combines city and state into one string for display
                    var cityState = data[i].city + ', ' + data[i].state;

                    // formats salary with commas and "$" symbol
                    var formattedSalary = '$' + data[i].salary.toLocaleString('en-US', {maximumFractionDigits: 0});
                    row.innerHTML = `
                        <td>${data[i].rank}</td>
                        <td>${cityState}</td>
                        <td>${formattedSalary}</td>
                    `;

                    row.setAttribute('data-city', data[i].city); // stores city separately from state so you can still filter by city
                    tableBody.appendChild(row);
                }
            }
        }

        // fetch and display data based on selections
        function fetchDataAndDisplay() {
            var profession = document.getElementById('profession').value;
            var sorting = document.getElementById('sorting').value;
            var state = document.getElementById('state').value;
            var city = document.getElementById('city').value.trim();
            var filePath = '';

            // determines CSV file path based on profession selection
            if (profession === 'software') {
                filePath = 'Software Developer Descending Cleaned.csv';
            } else if (profession === 'mechanical') {
                filePath = 'Mechanical Engineer Descending Cleaned.csv';
            }

            // fetch CSV file
            fetch(filePath)
            .then(response => response.text())
            .then(csv => {
                var data = parseCSV(csv);

                // filters data based on state
                if (state !== 'all') {
                    data = data.filter(item => item.state === state.toUpperCase());
                }

                // filters data based on city
                if (city !== '') {
                    data = data.filter(item => item.city.toLowerCase().includes(city.toLowerCase()));
                }

                // sorts data based on selecting high to low, or low to high
                if (sorting === 'highest') {
                    data.sort((a, b) => b.salary - a.salary);
                } else if (sorting === 'lowest') {
                    data.sort((a, b) => a.salary - b.salary);
                }
                displayData(data);
            })
            .catch(error => console.error('Error fetching CSV file:', error));
        }

        // event listeners for dropdown changes
        document.getElementById('profession').addEventListener('change', fetchDataAndDisplay);
        document.getElementById('sorting').addEventListener('change', fetchDataAndDisplay);
        document.getElementById('state').addEventListener('change', fetchDataAndDisplay);
        document.getElementById('city').addEventListener('input', function() {
            fetchDataAndDisplay(); // Call fetchDataAndDisplay on each input change
        });
        document.getElementById('searchBtn').addEventListener('click', fetchDataAndDisplay);
        document.getElementById('clearBtn').addEventListener('click', function() {
            document.getElementById('profession').value = 'software'; // set default profession
            document.getElementById('sorting').value = 'highest'; // set default sorting
            document.getElementById('state').value = 'all'; // set default state
            document.getElementById('city').value = ''; // clear search input
            fetchDataAndDisplay(); // fetch and display default data
        });

        // initial data fetch and display
        fetchDataAndDisplay();
    });
</script>
</body>
</html>
